{"ast":null,"code":"import _slicedToArray from \"/home/kau/projects/acad/spe/mind-note-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/kau/projects/acad/spe/mind-note-frontend/src/components/feed.component.js\";\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { Redirect, Link } from \"react-router-dom\";\nimport { variables } from \"../urls.js\";\n\nfunction useForceUpdate() {\n  let _useState = useState(true),\n      _useState2 = _slicedToArray(_useState, 2),\n      value = _useState2[0],\n      setState = _useState2[1];\n\n  return () => setState(!value);\n}\n\nlet renderedFeed = \"\";\n\nfunction Feed({\n  getToken,\n  setBookId\n}) {\n  const _useState3 = useState(null),\n        _useState4 = _slicedToArray(_useState3, 2),\n        feed = _useState4[0],\n        setFeed = _useState4[1];\n\n  const forceUpdate = useForceUpdate();\n\n  const addNewComment = async (e, data) => {\n    e.preventDefault();\n    const commentContent = e.target[0].value;\n    const bookId = e.target.id;\n    const url = variables.serverUrl + variables.postNoteEndpoint;\n    const token = getToken();\n    const res = axios.post(url, {\n      book_id: bookId,\n      user_id: 1,\n      content: 1\n    }, {\n      headers: {\n        Authorization: 'Bearer ' + token.access\n      },\n      crossDomain: false,\n      params: {\n        book_id: bookId\n      }\n    });\n    e.target.reset(); // renderFeed();\n  };\n\n  const fetchFeed = async () => {\n    const url = variables.serverUrl + variables.fetchFeedEndpoint;\n    const token = getToken();\n    const response = await axios.get(url, {\n      headers: {\n        Authorization: 'Bearer ' + token.access\n      },\n      crossDomain: false,\n      params: {\n        user_id: '1'\n      }\n    });\n    setFeed(response.data);\n    console.log(response.data);\n  };\n\n  useEffect(() => {\n    fetchFeed();\n  }, []);\n  useEffect(() => {\n    renderFeed();\n  }, [feed]);\n\n  function getTagCards(tags) {\n    var t = [];\n\n    for (var i in tags) {\n      t.push(React.createElement(\"div\", {\n        className: \"pill\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 55\n        },\n        __self: this\n      }, tags[i].name));\n    }\n\n    return t;\n  }\n\n  function renderFeed() {\n    console.log(\"ASD\");\n    console.log(feed);\n\n    if (feed) {\n      renderedFeed = [];\n\n      for (var i = 0; i < feed.length; i++) {\n        console.log(feed[i]);\n        renderedFeed.push(React.createElement(\"div\", {\n          className: \"feed-card \",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 71\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"book row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 72\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"header\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 73\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          className: \"profile-picture\",\n          src: require('../static/pf.png'),\n          alt: \"profile picture\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 74\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          className: \"username\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 75\n          },\n          __self: this\n        }, feed[i].user.first_name), React.createElement(\"div\", {\n          className: \"timestamp\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 78\n          },\n          __self: this\n        }, feed[i].time_ago)), React.createElement(\"div\", {\n          className: \"column\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 82\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 83\n          },\n          __self: this\n        }, React.createElement(Link, {\n          className: \"title\",\n          to: \"/feed/\" + feed[i].id + \"/notes\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84\n          },\n          __self: this\n        }, React.createElement(\"h4\", {\n          id: feed[i].id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85\n          },\n          __self: this\n        }, feed[i].title))), React.createElement(\"div\", {\n          className: \"description\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 91\n          },\n          __self: this\n        }, feed[i].description)), React.createElement(\"div\", {\n          className: \"column-right\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 96\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"feed-card-tags\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 97\n          },\n          __self: this\n        }, getTagCards(feed[i].tags)))), React.createElement(\"div\", {\n          className: \"comments\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 103\n          },\n          __self: this\n        }, feed[i].comments.map(comment => React.createElement(\"div\", {\n          className: \"comment\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 106\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"header\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 107\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          className: \"profile-picture\",\n          src: require('../static/pf.png'),\n          alt: \"profile picture\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 108\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          className: \"username\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 109\n          },\n          __self: this\n        }, comment.user.first_name), React.createElement(\"div\", {\n          className: \"timestamp\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110\n          },\n          __self: this\n        }, comment.time_ago)), React.createElement(\"div\", {\n          className: \"\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112\n          },\n          __self: this\n        }, comment.content)))), React.createElement(\"div\", {\n          className: \"new-comment\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 117\n          },\n          __self: this\n        }, React.createElement(\"form\", {\n          onSubmit: addNewComment,\n          id: feed[i].id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 118\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          placeholder: \"Add new comment\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119\n          },\n          __self: this\n        })))));\n      }\n\n      console.log(renderedFeed);\n      console.log(typeof renderedFeed);\n      forceUpdate();\n    } else {\n      renderedFeed = \"\";\n    }\n  }\n\n  return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n    className: \"feed\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, renderedFeed));\n}\n\nexport default Feed;","map":{"version":3,"sources":["/home/kau/projects/acad/spe/mind-note-frontend/src/components/feed.component.js"],"names":["React","useState","useEffect","axios","Redirect","Link","variables","useForceUpdate","value","setState","renderedFeed","Feed","getToken","setBookId","feed","setFeed","forceUpdate","addNewComment","e","data","preventDefault","commentContent","target","bookId","id","url","serverUrl","postNoteEndpoint","token","res","post","book_id","user_id","content","headers","Authorization","access","crossDomain","params","reset","fetchFeed","fetchFeedEndpoint","response","get","console","log","renderFeed","getTagCards","tags","t","i","push","name","length","require","user","first_name","time_ago","title","description","comments","map","comment"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { Redirect, Link} from \"react-router-dom\";\nimport {variables} from \"../urls.js\";\n\nfunction useForceUpdate(){\n  let [value, setState] = useState(true);\n  return () => setState(!value);\n}\n\nlet renderedFeed = \"\";\n\nfunction Feed({getToken, setBookId}) {\n  const [feed, setFeed] = useState(null);\n  const forceUpdate = useForceUpdate();\n\n  const addNewComment = async (e, data) => {\n    e.preventDefault();\n    const commentContent = e.target[0].value;\n    const bookId = e.target.id\n\n    const url = variables.serverUrl + variables.postNoteEndpoint;\n    const token = getToken();\n    const res = axios.post(url, {\n        book_id: bookId,\n        user_id: 1,\n        content: 1,\n    }, { headers: { Authorization: 'Bearer ' + token.access }, crossDomain: false, params: {book_id: bookId}});\n\n    e.target.reset();\n    // renderFeed();\n  }\n\n  const fetchFeed = async () => {\n    const url = variables.serverUrl + variables.fetchFeedEndpoint;\n    const token = getToken();\n    const response = await axios.get(url, { headers: { Authorization: 'Bearer ' + token.access }, crossDomain: false, params: {user_id: '1'}});\n    setFeed(response.data);\n    console.log(response.data);\n  }\n\n\n  useEffect(() => {\n    fetchFeed();\n\t}, []);\n\n  useEffect(() => {\n    renderFeed();\n\t}, [feed]);\n\n  function getTagCards(tags) {\n    var t = [];\n    for (var i in tags) {\n      t.push(\n        <div className=\"pill\">\n          {tags[i].name}\n        </div>\n      );\n    }\n    return t;\n  }\n\n  function renderFeed() {\n    console.log(\"ASD\");\n    console.log(feed);\n    if (feed) {\n      renderedFeed = [];\n      for(var i = 0; i < feed.length; i++) {\n        console.log(feed[i]);\n        renderedFeed.push(\n          <div className=\"feed-card \">\n          <div className=\"book row\">\n            <div className=\"header\">\n             <img className=\"profile-picture\" src={require('../static/pf.png')} alt=\"profile picture\"/> \n              <div className=\"username\">\n                {feed[i].user.first_name}\n              </div>\n              <div className=\"timestamp\">\n                {feed[i].time_ago}\n              </div>\n            </div>\n            <div className=\"column\">\n                <div>\n                    <Link className=\"title\" to={\"/feed/\" + feed[i].id + \"/notes\"} >\n                      <h4 id={feed[i].id}>\n                          {feed[i].title}\n                  \n                      </h4>\n                    </Link> \n                </div>\n                <div className=\"description\">\n                  {feed[i].description}\n                </div>\n              \n            </div>\n            <div className=\"column-right\">\n              <div className=\"feed-card-tags\">\n                  {getTagCards(feed[i].tags)}\n              </div>\n            </div>\n          \n          </div>\n        <div className=\"comments\">\n                {feed[i].comments.map( \n                  comment => (\n                    <div className=\"comment\">\n                    <div className=\"header\">\n                         <img className=\"profile-picture\" src={require('../static/pf.png')} alt=\"profile picture\"/> \n                        <div className=\"username\">{comment.user.first_name}</div>\n                        <div className=\"timestamp\">{comment.time_ago}</div>\n                    </div>\n                      <div className=\"\">{comment.content}</div>\n                    </div>\n                  )\n                )}\n          </div>\n          <div className=\"new-comment\">\n            <form onSubmit={addNewComment} id={feed[i].id}>\n              <input placeholder=\"Add new comment\" />\n            </form>\n          </div>\n          </div>\n        );\n      }\n      console.log(renderedFeed);\n      console.log(typeof(renderedFeed));\n      forceUpdate();\n    }\n    else {\n      renderedFeed = \"\";\n    }\n\n  }\n  return (\n    <>\n          <div className=\"feed\">\n            {renderedFeed}\n          </div>\n    </>\n\n  )\n\n}\n\nexport default Feed;\n"]},"metadata":{},"sourceType":"module"}